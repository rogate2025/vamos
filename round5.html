<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spin the Wheel Game</title>
    <style>
        body {
            margin: 0;
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #0a1a3d 0%, #1e3c72 50%, #000000 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            overflow: auto;
            color: #fff;
            position: relative;
        }

        .game-container {
            text-align: center;
            position: relative;
            padding: 20px;
        }

        h1 {
            font-size: 48px;
            text-shadow: 0 0 10px #ffd700;
            margin-bottom: 20px;
        }

        .wheel-container {
            width: 450px;
            height: 450px;
            margin: 0 auto;
            position: relative;
            border-radius: 50%;
            background: radial-gradient(circle, #ffd700 10%, transparent 60%);
        }

        canvas {
            width: 100%;
            height: 100%;
            border-radius: 50%;
        }

        .pointer {
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-top: 40px solid #ffd700;
            z-index: 10;
            filter: drop-shadow(0 0 10px #ffd700);
        }

        #result, #guruji-result {
            font-size: 24px;
            font-weight: bold;
            color: #ffd700;
            margin-top: 20px;
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            text-shadow: 0 0 10px #ffd700;
        }

        button {
            padding: 15px 30px;
            font-size: 18px;
            background: linear-gradient(45deg, #ffaa00, #ffd700);
            border: none;
            border-radius: 25px;
            color: #0a1a3d;
            cursor: pointer;
            margin-top: 20px;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 15px #ffd700;
        }

        button:disabled {
            background: #666666;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .guruji {
            position: fixed;
            bottom: 20px;
            left: 20px;
            width: 200px;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .guruji:hover {
            transform: scale(1.1);
        }

        #questionModal {
            display: block; /* Always visible in layout, but hidden with opacity */
            opacity: 0; /* Hidden by default */
            pointer-events: none; /* Prevent interaction when hidden */
            transition: opacity 0.5s ease; /* Smooth fade over 0.5 seconds */
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #1e3c72, #0a1a3d);
            padding: 30px;
            border-radius: 20px;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.7);
            z-index: 1000;
            width: 80%;
            max-width: 500px;
            text-align: center;
        }

        #questionModal.active {
            opacity: 1; /* Fully visible when active */
            pointer-events: auto; /* Allow interaction */
        }

        #closeModal {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 24px;
            cursor: pointer;
            color: #ff6f61;
        }

        #questionContent {
            font-size: 20px;
            margin-bottom: 20px;
        }

        #timer {
            font-size: 18px;
            margin-bottom: 20px;
            opacity: 0;
            color: #ffd700;
            text-shadow: 0 0 10px #ffd700;
        }

        @keyframes pulseGlow {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        @keyframes shadowPulse {
            0% { box-shadow: 0 0 5px #ffd700; }
            50% { box-shadow: 0 0 20px #ffd700; }
            100% { box-shadow: 0 0 5px #ffd700; }
        }

        @keyframes textGlow {
            0% { text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5), 0 0 5px #ffd700; }
            50% { text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5), 0 0 15px #ffd700; }
            100% { text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5), 0 0 5px #ffd700; }
        }

        .highlight {
            background-color: #ffd700; /* Gold background */
            color: #000; /* Black text for contrast */
            padding: 2px 5px; /* Padding for spacing */
            border-radius: 3px; /* Rounded corners */
            animation: shadowPulse 2s infinite, textGlow 2s infinite; /* Glowing effects */
            font-size: 1.1em; /* Slightly larger text */
        }

        .fireworks {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 100%;
            height: 100%;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.5s;
            z-index: 999;
        }

        .particle {
            position: absolute;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            opacity: 0;
            animation: explode 1.5s ease-out forwards;
        }

        @keyframes explode {
            0% { transform: translate(0, 0); opacity: 1; }
            100% { transform: translate(var(--x), var(--y)); opacity: 0; }
        }

        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            opacity: 0;
            animation: fall 3s ease-out forwards;
            z-index: 1001;
        }

        @keyframes fall {
            0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
        }

        .balloon {
            position: fixed;
            width: 30px;
            height: 40px;
            border-radius: 50% 50% 50% 50% / 60% 60% 40% 40%;
            opacity: 0;
            animation: rise 4s ease-out forwards;
            z-index: 1001;
        }

        @keyframes rise {
            0% { transform: translateY(100vh); opacity: 1; }
            100% { transform: translateY(-100vh); opacity: 0; }
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% { transform: translateY(0); }
            40% { transform: translateY(-30px); }
            60% { transform: translateY(-15px); }
        }

        .bouncing-balloon {
            animation: bounce 2s infinite;
        }

        #congratsMessage {
            position: fixed;
            top: 20%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            padding: 20px 40px;
            border-radius: 15px;
            font-size: 24px;
            color: #ffd700;
            text-shadow: 0 0 10px #ffd700;
            opacity: 0;
            transition: opacity 0.5s;
            z-index: 1002;
            display: none;
        }

        .guruji-popup {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: linear-gradient(135deg, #1e3c72, #0a1a3d);
            padding: 20px;
            border-radius: 20px;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.7);
            z-index: 1000;
            width: 90%;
            max-width: 400px;
            text-align: center;
        }

        .guruji-content {
            position: relative;
        }

        .guruji-image {
            width: 100px;
            margin-bottom: 10px;
        }

        #guruji-intro {
            font-size: 16px;
            margin-bottom: 20px;
        }

        .guruji-content .wheel-container {
            width: 300px;
            height: 300px;
            margin: 20px auto;
            position: relative;
            border-radius: 50%;
            background: radial-gradient(circle, #ffd700 10%, transparent 60%);
        }

        .guruji-content canvas {
            width: 100%;
            height: 100%;
            border-radius: 50%;
        }

        .guruji-content .pointer {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 30px solid #ffd700;
            z-index: 10;
            filter: drop-shadow(0 0 10px #ffd700);
        }

        .guruji-content button {
            padding: 10px 20px;
            font-size: 16px;
            margin: 10px;
        }

        .guruji-close {
            background: #ff6f61;
            color: #fff;
        }

        #guruji-question-container {
            opacity: 0; /* Hidden by default */
            pointer-events: none; /* Prevent interaction when hidden */
            transition: opacity 0.5s ease; /* Smooth fade */
            margin-top: 20px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.6);
            border-radius: 10px;
            position: relative;
            color: #fff;
        }

        #guruji-question-container.visible {
            opacity: 1; /* Visible when active */
            pointer-events: auto; /* Allow interaction */
        }

        #guruji-question-content {
            font-size: 18px;
            margin-bottom: 10px;
        }

        #guruji-timer {
            font-size: 16px;
            margin-bottom: 10px;
        }

        #closeGurujiQuestion {
            position: absolute;
            top: 5px;
            right: 5px;
            cursor: pointer;
            color: #ff6f61;
            font-size: 20px;
        }

        .glitter {
            position: absolute;
            width: 5px;
            height: 5px;
            background: rgba(255, 215, 0, 0.8);
            border-radius: 50%;
            pointer-events: none;
            animation: glitterFade 1s ease-out forwards;
        }

        @keyframes glitterFade {
            0% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(0); }
        }

        .ripple {
            position: absolute;
            border-radius: 50%;
            background: rgba(255, 215, 0, 0.3);
            pointer-events: none;
            animation: ripple 1s ease-out forwards;
        }

        @keyframes ripple {
            0% { transform: scale(0); opacity: 1; }
            100% { transform: scale(4); opacity: 0; }
        }

        .snowflake, .leaf {
            position: fixed;
            font-size: 1.5em;
            opacity: 0.8;
            animation: fallAnimation 5s linear forwards;
        }

        @keyframes fallAnimation {
            0% { transform: translateY(-100vh) rotate(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotate(360deg); opacity: 0; }
        }

        .bubble {
            position: fixed;
            width: 20px;
            height: 20px;
            background: rgba(255, 215, 0, 0.5);
            border-radius: 50%;
            animation: bubblePop 2s ease-out forwards;
        }

        @keyframes bubblePop {
            0% { transform: translateY(100vh) scale(0.5); opacity: 1; }
            80% { transform: translateY(-20vh) scale(1); opacity: 1; }
            100% { transform: translateY(-30vh) scale(0); opacity: 0; }
        }

        .confetti-trail {
            position: absolute;
            width: 8px;
            height: 8px;
            background: hsl(var(--hue), 100%, 50%);
            animation: confettiTrail 1s ease-out forwards;
        }

        @keyframes confettiTrail {
            0% { opacity: 1; transform: translate(0, 0); }
            100% { opacity: 0; transform: translate(var(--x), var(--y)); }
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <audio id="bgm" loop>
        <source src="bgm.mp3" type="audio/mpeg">
    </audio>
    <audio id="gurujiMusic" src="guruji.mp3"></audio>
    <audio id="spinMusic" src="spin.mp3"></audio>
    <audio id="celebrationMusic" src="celebration.mp3"></audio>

    <div class="game-container">
        <h1>Spin the Wheel</h1>
        <div class="wheel-container">
            <div class="pointer"></div>
            <canvas id="wheel" width="450" height="450"></canvas>
        </div>
        <div id="result"></div>
        <button id="spinBtn">Spin Now!</button>
        <img src="guruji.png" class="guruji" onclick="openGurujiPopup()">
    </div>

    <div id="questionModal">
        <div id="closeModal">❌</div>
        <div id="questionContent"></div>
        <div id="timer"></div>
        <button id="answerBtn">Show Answer</button>
        <button id="congratsBtn" style="display: none;">Congratulations!</button>
    </div>

    <div id="congratsMessage"></div>

    <div class="guruji-popup" id="guruji-popup">
        <div class="guruji-content">
            <img src="guruji.png" alt="Guruji" class="guruji-image">
            <p id="guruji-intro">Greetings, knowledge seekers! I am Guruji, your Quiz Master. Spin the wheel to get your challenge!</p>
            <div class="wheel-container">
                <div class="pointer"></div>
                <canvas id="guruji-wheel" width="300" height="300"></canvas>
            </div>
            <button id="guruji-spinBtn">Spin Now!</button>
            <div id="guruji-result"></div>
            <div id="guruji-question-container">
                <div id="guruji-question-content"></div>
                <div id="guruji-timer"></div>
                <button id="guruji-answerBtn">Show Answer</button>
                <button id="guruji-congratsBtn" style="display: none;">Congratulations!</button>
                <div id="closeGurujiQuestion">❌</div>
            </div>
            <button class="guruji-close" onclick="closeGurujiPopup()">Close</button>
        </div>
    </div>

    <script>
        window.onload = function() {
            window.open('video/round5.mp4', '_blank');
        };

        // Autoplay background music on first click
        document.addEventListener('click', function() {
            const audio = document.getElementById('bgm');
            if (audio.paused) {
                audio.play().catch(error => console.log("Background music play failed:", error));
            }
        }, { once: true });

        // Main Wheel Setup
        const canvas = document.getElementById('wheel');
        const ctx = canvas.getContext('2d');
        const spinBtn = document.getElementById('spinBtn');
        const resultDiv = document.getElementById('result');
        const fireworksDiv = document.createElement('div');
        fireworksDiv.className = 'fireworks';
        document.body.appendChild(fireworksDiv);
        const questionModal = document.getElementById('questionModal');
        const questionContent = document.getElementById('questionContent');
        const closeModal = document.getElementById('closeModal');
        const answerBtn = document.getElementById('answerBtn');
        const congratsBtn = document.getElementById('congratsBtn');
        const congratsMessage = document.getElementById('congratsMessage');
        const spinMusic = document.getElementById('spinMusic');
        const bgm = document.getElementById('bgm');
        const celebrationMusic = document.getElementById('celebrationMusic');
        let timerInterval;
        let gurujiTimerInterval;
        let mainCurrentQuestion = null;
        let gurujiCurrentQuestion = null;

        const questionSets = {
            "50": [
                { question: "Which city is hosting the 2025 Special Olympics World Winter Games from March 8 to 15, 2025?", answer: "Turin, Italy" },
                { question: "Which company became the first commercial entity to successfully land on the Moon on March 2, 2025?", answer: "Firefly Aerospace" },
                { question: "Who was elected leader of the Liberal Party of Canada on March 9, 2025, becoming the new Prime Minister?", answer: "Mark Carney" },
                { question: "Which former Philippine president was arrested on March 11, 2025, following an International Criminal Court warrant?", answer: "Rodrigo Duterte" },
                { question: "Which militant group seized control of Goma in the Democratic Republic of the Congo on January 26, 2025?", answer: "The March 23 Movement (M23)" },
                { question: "In what year did Fr. Hannibal pass away?", answer: "1927" },
                { question: "When is the feast day of Fr. Hannibal commemorated?", answer: "June 1" },
                { question: "At what age did Hannibal lose his father?", answer: "Before reaching 2 years old" },
                { question: "Besides his apostolic work, what artistic talent did Hannibal display?", answer: "He was a gifted poet" },
                { question: "What central event in Christianity is cited in paragraph 20 as the basis for hope?", answer: "The death and resurrection of Jesus Christ." },
                { question: "What metaphor does paragraph 20 use to describe the impact of Christ’s resurrection on the concept of death?", answer: "That death is not an end but a passage to eternal life." },
                { question: "What key question about human destiny does paragraph 21 raise?", answer: "What, then, will become of us after death?" },
                { question: "Which famous artistic work is referenced in paragraph 22 as portraying God’s judgement?", answer: "Michelangelo’s magnum opus in the Sistine Chapel." },
                { question: "വിശുദ്ധ യോഹന്നാൻ ശ്ലീഹായുടെ ഒന്നാം ലേഖനം 5:7 ൽ ശ്ലീഹ പരിചയപ്പെടുത്തുന്ന ക്രിസ്തുവിന്റെ മൂന്ന് സാക്ഷികൾ ഏവ?", answer: "ആത്മാവ്, ജലം, രക്തം" },
                { question: "ഞാന്‍ ഇവയെല്ലാം എഴുതിയത് ദൈവപുത്രന്റെ നാമത്തില്‍ വിശ്വസിക്കുന്ന നിങ്ങൾക്ക് നിത്യജീവൻ ഉണ്ട് എന്ന് നിങ്ങൾ അറിയേണ്ടതിനാണ്. ഏത് ലേഖനത്തെ കുറിച്ചാണ് ഇവിടെ പരാമർശിക്കപ്പെടുന്നത്?", answer: "1 യോഹന്നാൻ (5:13)" },
                { question: "എന്തുപദേശം നൽകി കൊണ്ടാണ് യോഹന്നാൻ ശ്ലീഹാ തന്റെ ഒന്നാം ലേഖനം അവസാനിപ്പിക്കുന്നത് (5:21)?", answer: "കുഞ്ഞുമക്കളെ വിഗ്രഹങ്ങളിൽ നിന്ന് അകന്നിരിക്കുവിൻ" }
            ],
            "100": [
                { question: "What was the primary purpose of Hannibal’s newspaper articles?", answer: "To defend the Church and advocate for social justice" },
                { question: "Fr. Hannibal became known as the ‘Apostle of Rogate’ due to his emphasis on what?", answer: "Vocations through prayer (the Rogate)" },
                { question: "Which early talent of Hannibal later influenced his apostolic work?", answer: "His gift for poetry." },
                { question: "Which scriptural reference is used in paragraph 22 to illustrate the expectation of mercy at judgement?", answer: "A passage from Wisdom (Wisdom 12:19-22)." },
                { question: "How does paragraph 23 explain the consequences of sin?", answer: "It states that every sin, even venial, leaves a mark and requires purification." },
                { question: "What does the indulgence represent in the Jubilee context according to paragraph 23?", answer: "It is a way of discovering and experiencing the unlimited nature of God’s mercy." },
                { question: "What role does Confession play in the life of a believer as described in paragraph 23?", answer: "It reconciles the believer with God, heals the heart, and enables them to experience forgiveness." },
                { question: "യോഹന്നാൻ ശ്ലീഹായുടെ മൂന്നാം ലേഖനം എഴുതപ്പെട്ടത് ആര്‍ക്ക്", answer: "സഭാ ശ്രേഷ്ഠനായ ഗായുസിന്" },
                { question: "യോഹന്നാൻ ശ്ലീഹാ തന്റെ രണ്ടാം ലേഖനത്തിൽ സ്നേഹത്തെ നിർവചിക്കുന്നത് എങ്ങനെ (1:6)", answer: "അവിടുത്തെ കൽപ്പനകൾ അനുസരിച്ച് നടക്കുക" },
                { question: "യൂദാശ്ലീഹാ തന്റെ ലേഖനത്തിൽ തന്നെ തന്നെ പരിചയപ്പെടുത്തുന്നത് എങ്ങനെ (1:1)", answer: "യേശുക്രിസ്തുവിന്റെ ദാസനും യാക്കോബിന്റെ സഹോദരനുമായ യൂദാസ്" }
            ],
            "150": [
                { question: "What does the inscription ‘Rogate Dominum Messis’ signify?", answer: "Prayer for Good workers" },
                { question: "Which significant event in Rome in 1869 influenced Hannibal’s vocational discernment?", answer: "The opening of the First Vatican Council" },
                { question: "Which practice did Hannibal regard as essential for nurturing his community’s spiritual life?", answer: "Daily personal prayer and reflection" },
                { question: "How is the Blessed Virgin Mary portrayed in paragraph 24?", answer: "As the Mother of Hope, who sustains and never abandons her children." },
                { question: "Which Marian title mentioned in paragraph 24 reflects Mary’s role as a beacon of hope?", answer: "Stella Maris." },
                { question: "What significant Marian celebration is noted in paragraph 24?", answer: "The fifth centenary of Our Lady of Guadalupe’s first apparition in 2031." },
                { question: "What metaphor does paragraph 25 use to describe the stability provided by hope?", answer: "The image of an anchor." },
                { question: "അവർ പിറുപിറുക്കുന്നവരും അസംതൃപ്തരും തങ്ങളുടെ ദുരാശകൾ കൊത്ത് വീതം നടക്കുന്നവരും വമ്പു പറയുന്നവരും കാര്യസാധ്യത്തിന് വേണ്ടി മുഖസ്തുതി പറയുന്നവരുമാണ്. ആരെക്കുറിച്ചാണ് ഇത് പരാമർശിക്കപ്പെടുന്നത് (16)", answer: "ആദത്തിൽ നിന്ന് ഏഴാം തലമുറക്കാരനായ ഹെനോക്ക് പ്രവചിച്ചവരെ കുറിച്ച്" },
                { question: "ഈ മനുഷ്യർ ശരീരത്തെ അശുദ്ധമാക്കുകയും അധികാരത്തെ തള്ളിപ്പറയുകയും മഹിമ അണിഞ്ഞ വരെ നിന്ദിക്കുകയും ചെയ്യുന്നു. എങ്ങനെയുള്ള മനുഷ്യരെയാണ് ശ്ലീഹ ഇവിടെ കുറ്റപ്പെടുത്തുന്നത് (8)", answer: "സ്വപ്നങ്ങളിൽ നിമഗ്നരായിരിക്കുന്ന മനുഷ്യർ" },
                { question: "കണ്ടാലും എത്ര വലിയ സ്നേഹമാണ് പിതാവ് നമ്മോട് കാണിച്ചത് ദൈവം മക്കൾ എന്ന് നാം വിളിക്കപ്പെടുന്നു നാം അങ്ങനെയാണ് താനും. അദ്ധ്യായവും വാക്യവും ഉദ്ധരിക്കുക", answer: "1 യോഹന്നാൻ 3:1" }
            ],
            "200": [
                { question: "What final message did Hannibal leave regarding his apostolic work?", answer: "To trust in God’s providence" },
                { question: "What hymn did Fr. Hannibal compose in honor of the Sacred Heart?", answer: "For the Greater Consolation of Jesus’ Heart!" },
                { question: "What was Hannibal’s reaction when he witnessed the poor man being ridiculed in the boarding house?", answer: "He immediately collected food and gave it to the poor man." },
                { question: "What overall message about the Jubilee is conveyed in paragraph 25?", answer: "That the Jubilee is a time to be drawn to hope and to spread that hope throughout the world." },
                { question: "According to paragraph 25, what does the anchor symbolize?", answer: "It symbolizes stability and security amid life’s turbulent storms." },
                { question: "How does paragraph 24 relate Mary’s experience at the cross to the theme of hope?", answer: "Despite witnessing the suffering and death of her Son, Mary never abandons her hope and trust in God." },
                { question: "What attitude should believers have toward the moment of judgement, as explained in paragraph 22?", answer: "They should prepare consciously and soberly while maintaining hope." },
                { question: "ഈ വിഷയത്തെക്കുറിച്ച് പറയുമ്പോൾ എല്ലാം ഇങ്ങനെ തന്നെയാണ് എല്ലാ ലേഖനങ്ങളിലും അവൻ എഴുതിയിരിക്കുന്നത്. ആരുടെ ലേഖനത്തെ കുറിച്ചാണ് ഇവിടെ പരാമർശിക്കുന്നത്. എന്താണ് ഇവിടെ പ്രതിപാദിച്ചിരിക്കുന്ന വിഷയം.(2 pet 2:16)", answer: "വിശുദ്ധ പൗലോസ് ശ്ലീഹായുടെ ലേഖനം,കർത്താവിന്റെ പ്രത്യാഗമനത്തെക്കുറിച്ച്" },
                { question: "ഒരു ഊമക്കഴുത മനുഷ്യസരത്തിൽ സംസാരിച്ചുകൊണ്ട് ആ പ്രവാചകന്റെ ഭ്രാന്തിന് അറുതി വരുത്തി. ഏത് പ്രവാചകനെയാണ് പത്രോസ് ശ്ലീഹ ഉദ്ദേശിക്കുന്നത്. (2 pet 2:16)", answer: "ബേവോറിന്റെ പുത്രനായ ബാലാം" },
                { question: "പ്രിയപ്പെട്ടവരെ കർത്താവിന്റെ മുൻപിൽ ഒരു ദിവസം ആയിരം വർഷങ്ങൾ പോലെയും ആയിരം വർഷങ്ങൾ ഒരു ദിവസം പോലെയുമാണ് എന്ന കാര്യം നിങ്ങൾ വിസ്മരിക്കരുത്. അദ്ധ്യായവും വാക്യവും ഉദ്ധരിക്കുക", answer: "2 പത്രോസ് 3:8" }
            ],
            "250": [
                { question: "Which historical event did Hannibal comment on in his articles?", answer: "The 1860 revolution in Italy" },
                { question: "How did Hannibal’s time at the boarding house shape his view on charity?", answer: "It instilled in him a lifelong commitment to serving the poor." },
                { question: "What characteristics did Hannibal see as essential to a priest’s life?", answer: "Spiritual leadership and active social service." },
                { question: "Which type of educational program did Hannibal introduce for the orphans in his care?", answer: "Evening schools teaching basic literacy and vocational skills." },
                { question: "What were his last words?", answer: "Let God handle things. God knows what He is doing. God knows what He is doing! I bless you." },
                { question: "What assurance about God’s love is given in paragraph 21?", answer: "That nothing in all creation can separate believers from the love of God." },
                { question: "നിയതിമാന്റെ പ്രാർത്ഥന വളരെ ശക്തിയുള്ളതും ഫലദായകവും ആണ് എന്ന് തെളിയിക്കാൻ യാക്കോബ് ശ്ലീഹ പരാമർശിക്കുന്ന പഴയ നിയമത്തിലെ പ്രവാചകൻ ആര് (5:17)", answer: "ഏലിയാ പ്രവാചകന്‍" },
                { question: "എല്ലാത്തരം വന്യമൃഗങ്ങളെയും പക്ഷികളെയും ഇഴജന്തുക്കളെയും സമുദ്രജീവികളെയും മനുഷ്യൻ ഇണക്കുന്നുണ്ട് ഇണക്കിയിട്ടുമുണ്ട് എന്നാൽ ഒരു മനുഷ്യനും നിയന്ത്രിക്കാൻ സാധിക്കാത്തത് എന്ത് ആണ് യാക്കോബ് ശ്ലീഹ പറയുന്നത് (3:8)", answer: "നാവിനെ" },
                { question: "വിശ്വാസം പ്രവർത്തികളാൽ പൂർണ്ണമാക്കപ്പെടുന്നു എന്ന് തെളിയിക്കാൻ യാക്കോബ് ശ്ലീഹ പരാമർശിക്കുന്ന വ്യക്തികൾ ആരൊക്കെ (2:23)", answer: "അബ്രഹാം, റാഹാബ്" },
                { question: "Which sacrament did Hannibal emphasize as a daily practice early in his clerical life?", answer: "Daily Holy Communion" },
                { question: "What central prayer did Hannibal promote among his followers?", answer: "The Rogate Prayer" },
                { question: "How did Hannibal interpret suffering within a spiritual context?", answer: "As divine instruction and a means of purification" },
                { question: "Which virtue did Hannibal consider most crucial in his spiritual life?", answer: "Charity" }
            ],
            "300": [
                { question: "What nickname did Hannibal sometimes use for the poor he served?", answer: "The true masters of the kingdom" },
                { question: "What did witnesses say about Hannibal’s life and work?", answer: "That he was a man of divine inspiration and boundless love" },
                { question: "What common theme appears in Hannibal’s early poetic works?", answer: "Devotion to the Virgin Mary and passion for Christ." },
                { question: "What method did Hannibal primarily use to support his charitable institutions in Avignone?", answer: "Organizing charity walks and public appeals for alms" },
                { question: "What did Hannibal believe was necessary to overcome personal weakness?", answer: "Relying on God’s strength and mercy" },
                { question: "How does paragraph 22 describe the nature of God’s judgement?", answer: "It is based on love and mercy rather than on human-like, earthly tribunals." },
                { question: "How does baptism relate to hope in the explanation given in paragraph 20?", answer: "Baptism signifies being buried with Christ and receiving a new life that transforms death into a passage to eternal life." },
                { question: "ആർക്കുവേണ്ടിയാണ് യാക്കോബ് ശ്ലീഹ തന്റെ ലേഖനം എഴുതിയത് 1:1", answer: "വിജാതീയരുടെ ഇടയിൽ ചിതറി പാർക്കുന്ന 12 ഗോത്രങ്ങൾക്ക്" },
                { question: "ദൈവത്തിന്റെ അജഗണത്തെ പരിപാലിക്കുമ്പോൾ എന്തെല്ലാം ശ്രദ്ധിക്കണം എന്ന് ആണ് ശ്രേഷ്ഠന്മാർക്ക് പത്രോസ് ശ്ലീഹ നൽകുന്ന ഉപദേശം (5:3)", answer: "ദൈവത്തെ പ്രതി സന്മനസ്സോടെ ആയിരിക്കണം, തീക്ഷ്ണതിയോടെ ആയിരിക്കണം, സൻന്മാതൃക നൽകി കൊണ്ടായിരിക്കണം" }
            ],
            "350": [
                { question: "How did Hannibal perceive personal suffering?", answer: "As a means to grow closer to Christ" },
                { question: "How did Hannibal view the act of giving?", answer: "As an expression of love and self-sacrifice" },
                { question: "How did Hannibal view the trials and hardships he faced?", answer: "As necessary sacrifices for the salvation of souls" },
                { question: "What significance did the train journey hold in Hannibal’s early spiritual life?", answer: "It sparked his desire to love Jesus beyond measure." },
                { question: "How does paragraph 22 describe the nature of God’s judgement?", answer: "It is based on love and mercy rather than on human-like, earthly tribunals." },
                { question: "പിതാവിന്റെ മുൻപിൽ പരിശുദ്ധവും നിഷ്കളങ്കവുമായ ഭക്തി എന്താണ്(1:27)", answer: "അനാഥരുടെയും വിധവകളുടെയും ഞെരുക്കങ്ങളിൽ അവരുടെ സഹായത്തിന് എത്തുക. ലോകത്തിന്റെ കളങ്കം ഏൽക്കാതെ തന്നെ തന്നെ കാത്തുസൂക്ഷിക്കുക." },
                { question: "ആരുടെ ഭക്തിയാണ് വ്യർത്ഥമായതു എന്ന് യാക്കോബ് ശ്ലീഹ പറയുന്നത്(1:26)?", answer: "താൻ ദൈവഭക്തനാണെന്ന് ഒരുവൻ വിചാരിക്കുകയും തന്റെ നാവിനെ നിയന്ത്രിക്കാതെ ഹൃദയത്തെ വഞ്ചിക്കുകയും ചെയ്താൽ" },
                { question: "ഉന്നതത്തിൽ നിന്നുള്ള ജ്ഞാനത്തിന്റെ പ്രത്യേകതകൾ ഏവ (3:17)?", answer: "ഉന്നതത്തിൽ നിന്നുള്ള ജ്ഞാനം ഒന്നാമത് ശുദ്ധവും, പിന്നെ സമാധാനപൂർണ്ണവും, വിനീതവും, വിധേയത്വമുള്ളതും, കാരുണ്യവും, സത്ഫലങ്ങളും നിറഞ്ഞതുമാണ്" }
            ],
            "400": [
                { question: "What is the capital of China?", answer: "Beijing" },
                { question: "What is the largest moon in the solar system?", answer: "Ganymede" },
                { question: "What is the chemical symbol for iron?", answer: "Fe" }
            ]
        };

        const gurujiQuestions = [
            { question: "What is the capital of Italy?", answer: "Rome" },
            { question: "Who wrote 'Hamlet'?", answer: "William Shakespeare" },
            { question: "What is the largest mammal on Earth?", answer: "Blue Whale" },
            { question: "What is the chemical symbol for water?", answer: "H2O" },
            { question: "Who painted the Sistine Chapel ceiling?", answer: "Michelangelo" },
            { question: "Which planet is closest to the Sun?", answer: "Mercury" },
            { question: "What is the tallest mountain in the world?", answer: "Mount Everest" }
        ];

        const segments = [
            { number: "50", visible: true },
            { number: "100", visible: true },
            { number: "150", visible: true },
            { number: "200", visible: true },
            { number: "250", visible: true },
            { number: "300", visible: true },
            { number: "350", visible: true },
            { number: "400", visible: true }
        ];

        const usedQuestions = {
            "50": [], "100": [], "150": [], "200": [],
            "250": [], "300": [], "350": [], "400": []
        };

        const colors = ['#ff6f61', '#6b5b95', '#88b04b', '#f7cac9', '#92a8d1', '#f9cb9c', '#b565a7', '#009b77'];
        const radius = canvas.width / 2;
        const arc = 2 * Math.PI / segments.length;
        const pointerAngle = 3 * Math.PI / 2;
        let currentAngle = 0;
        let isSpinning = false;
        let lastLandedNumber = null;

        const motivationalQuotes = [
            "Great job! The only way to do great work is to love what you do.",
            "Well done! Success is the sum of small efforts repeated day in and day out.",
            "Fantastic! Believe you can and you're halfway there."
        ];

        // Guruji Wheel Setup
        const gurujiCanvas = document.getElementById('guruji-wheel');
        const gurujiCtx = gurujiCanvas.getContext('2d');
        const gurujiRadius = gurujiCanvas.width / 2;
        const gurujiArc = 2 * Math.PI / gurujiQuestions.length;
        let gurujiCurrentAngle = 0;
        let gurujiIsSpinning = false;
        let gurujiLastLandedSegment = null;

        const gurujiSegments = gurujiQuestions.map((q, index) => ({
            number: (index + 1).toString(),
            visible: true,
            question: q
        }));

        // Utility Functions
        function normalizeAngle(angle) {
            angle = angle % (2 * Math.PI);
            if (angle < 0) angle += 2 * Math.PI;
            return angle;
        }

        // Main Wheel Functions
        function drawWheel() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            segments.forEach((segment, i) => {
                const angle = currentAngle + (i * arc);
                ctx.beginPath();
                ctx.fillStyle = segment.visible ? colors[i] : '#333333';
                ctx.moveTo(radius, radius);
                ctx.arc(radius, radius, radius, angle, angle + arc);
                ctx.lineTo(radius, radius);
                ctx.fill();

                ctx.save();
                ctx.translate(radius, radius);
                ctx.rotate(angle + arc / 2);
                ctx.fillStyle = segment.visible ? '#0a1a3d' : '#666666';
                ctx.font = 'bold 24px Poppins';
                ctx.textAlign = 'right';
                ctx.fillText(segment.number, radius - 30, 10);
                ctx.restore();

                if (!segment.visible) {
                    ctx.beginPath();
                    ctx.fillStyle = 'rgba(0, 0, 0, 0.7)';
                    ctx.moveTo(radius, radius);
                    ctx.arc(radius, radius, radius, angle, angle + arc);
                    ctx.lineTo(radius, radius);
                    ctx.fill();
                }
            });
        }

        function getSegmentAtAngle(angle) {
            const visibleSegments = segments.filter(s => s.visible);
            if (visibleSegments.length === 0) return null;
            const relativeAngle = normalizeAngle(angle - currentAngle);
            const segmentIndex = Math.floor(relativeAngle / arc) % visibleSegments.length;
            return visibleSegments[segmentIndex];
        }

        function handleWheelClick(event) {
            if (isSpinning || !lastLandedNumber) return;

            const rect = canvas.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;
            const dx = x - radius;
            const dy = y - radius;
            const dist = Math.sqrt(dx * dx + dy * dy);
            if (dist > radius) return;

            const clickAngle = Math.atan2(dy, dx);
            const clickedSegment = getSegmentAtAngle(clickAngle);
            if (clickedSegment && clickedSegment.number === lastLandedNumber) {
                mainCurrentQuestion = getRandomQuestion(lastLandedNumber);
                if (mainCurrentQuestion) {
                    showQuestionModal(mainCurrentQuestion.question);
                } else {
                    resultDiv.textContent = `Section ${lastLandedNumber} questions exhausted!`;
                    resultDiv.style.opacity = '1';
                }
            } else {
                alert(`Please click on the landed sector: ${lastLandedNumber}`);
            }
        }

        function getRandomQuestion(setNumber) {
            const availableQuestions = questionSets[setNumber].filter(q => !usedQuestions[setNumber].includes(q));
            if (availableQuestions.length === 0) {
                const segment = segments.find(s => s.number === setNumber);
                segment.visible = false;
                drawWheel();
                return null;
            }
            const question = availableQuestions[Math.floor(Math.random() * availableQuestions.length)];
            usedQuestions[setNumber].push(question);
            if (availableQuestions.length === 1) {
                const segment = segments.find(s => s.number === setNumber);
                segment.visible = false;
                drawWheel();
            }
            return question;
        }

        function spinWheel() {
            if (isSpinning) return;

            const visibleSegments = segments.filter(s => s.visible);
            if (visibleSegments.length === 0) {
                resultDiv.textContent = "All questions exhausted!";
                resultDiv.style.opacity = '1';
                spinBtn.disabled = true;
                return;
            }

            isSpinning = true;
            spinBtn.disabled = true;
            resultDiv.style.opacity = '0';

            bgm.pause();
            spinMusic.play().catch(error => console.log("Spin music play failed:", error));

            const spins = 5 + Math.floor(Math.random() * 5);
            const randomSegmentIndex = Math.floor(Math.random() * visibleSegments.length);
            const segmentCenter = segments.indexOf(visibleSegments[randomSegmentIndex]) * arc + arc / 2;
            const delta = normalizeAngle(pointerAngle - segmentCenter);
            const targetAngle = delta + 2 * Math.PI * spins;

            let startTime;
            const duration = 5000;

            function animate(timestamp) {
                if (!startTime) startTime = timestamp;
                const elapsed = timestamp - startTime;
                const progress = Math.min(elapsed / duration, 1);
                const easeProgress = 1 - Math.pow(1 - progress, 4);
                currentAngle = easeProgress * targetAngle;
                drawWheel();
                if (progress < 1) {
                    requestAnimationFrame(animate);
                } else {
                    currentAngle = targetAngle;
                    drawWheel();
                    const selected = getSegmentAtAngle(pointerAngle);
                    lastLandedNumber = selected.number;
                    resultDiv.textContent = `You landed on: ${selected.number}`;
                    resultDiv.style.opacity = '1';
                    createFireworks();
                    isSpinning = false;
                    spinBtn.disabled = false;
                    spinMusic.pause();
                    spinMusic.currentTime = 0;
                    bgm.play().catch(error => console.log("Background music resume failed:", error));
                }
            }
            requestAnimationFrame(animate);
        }

        // Guruji Wheel Functions
        function drawGurujiWheel() {
            gurujiCtx.clearRect(0, 0, gurujiCanvas.width, gurujiCanvas.height);
            gurujiSegments.forEach((segment, i) => {
                const angle = gurujiCurrentAngle + (i * gurujiArc);
                gurujiCtx.beginPath();
                gurujiCtx.fillStyle = segment.visible ? colors[i % colors.length] : '#333333';
                gurujiCtx.moveTo(gurujiRadius, gurujiRadius);
                gurujiCtx.arc(gurujiRadius, gurujiRadius, gurujiRadius, angle, angle + gurujiArc);
                gurujiCtx.lineTo(gurujiRadius, gurujiRadius);
                gurujiCtx.fill();

                gurujiCtx.save();
                gurujiCtx.translate(gurujiRadius, gurujiRadius);
                gurujiCtx.rotate(angle + gurujiArc / 2);
                gurujiCtx.fillStyle = segment.visible ? '#0a1a3d' : '#666666';
                gurujiCtx.font = 'bold 18px Poppins';
                gurujiCtx.textAlign = 'right';
                gurujiCtx.fillText(segment.number, gurujiRadius - 20, 5);
                gurujiCtx.restore();

                if (!segment.visible) {
                    gurujiCtx.beginPath();
                    gurujiCtx.fillStyle = 'rgba(0, 0, 0, 0.7)';
                    gurujiCtx.moveTo(gurujiRadius, gurujiRadius);
                    gurujiCtx.arc(gurujiRadius, gurujiRadius, gurujiRadius, angle, angle + gurujiArc);
                    gurujiCtx.lineTo(gurujiRadius, gurujiRadius);
                    gurujiCtx.fill();
                }
            });
        }

        function getGurujiSegmentAtAngle(angle) {
            const visibleSegments = gurujiSegments.filter(s => s.visible);
            if (visibleSegments.length === 0) return null;
            const relativeAngle = normalizeAngle(angle - gurujiCurrentAngle);
            const segmentIndex = Math.floor(relativeAngle / gurujiArc) % visibleSegments.length;
            return visibleSegments[segmentIndex];
        }

        function spinGurujiWheel() {
            if (gurujiIsSpinning) return;

            const visibleSegments = gurujiSegments.filter(s => s.visible);
            if (visibleSegments.length === 0) {
                document.getElementById('guruji-result').textContent = "All questions exhausted!";
                document.getElementById('guruji-result').style.opacity = '1';
                document.getElementById('guruji-spinBtn').disabled = true;
                return;
            }

            gurujiIsSpinning = true;
            document.getElementById('guruji-spinBtn').disabled = true;
            document.getElementById('guruji-result').style.opacity = '0';

            bgm.pause();
            spinMusic.play().catch(error => console.log("Spin music play failed:", error));

            const spins = 5 + Math.floor(Math.random() * 5);
            const randomSegmentIndex = Math.floor(Math.random() * visibleSegments.length);
            const segmentCenter = gurujiSegments.indexOf(visibleSegments[randomSegmentIndex]) * gurujiArc + gurujiArc / 2;
            const delta = normalizeAngle(pointerAngle - segmentCenter);
            const targetAngle = delta + 2 * Math.PI * spins;

            let startTime;
            const duration = 5000;

            function animate(timestamp) {
                if (!startTime) startTime = timestamp;
                const elapsed = timestamp - startTime;
                const progress = Math.min(elapsed / duration, 1);
                const easeProgress = 1 - Math.pow(1 - progress, 4);
                gurujiCurrentAngle = easeProgress * targetAngle;
                drawGurujiWheel();
                if (progress < 1) {
                    requestAnimationFrame(animate);
                } else {
                    gurujiCurrentAngle = targetAngle;
                    drawGurujiWheel();
                    const selected = getGurujiSegmentAtAngle(pointerAngle);
                    gurujiLastLandedSegment = selected;
                    document.getElementById('guruji-result').textContent = `You landed on: ${selected.number}`;
                    document.getElementById('guruji-result').style.opacity = '1';
                    createFireworks();
                    gurujiIsSpinning = false;
                    document.getElementById('guruji-spinBtn').disabled = false;
                    spinMusic.pause();
                    spinMusic.currentTime = 0;
                    bgm.play().catch(error => console.log("Background music resume failed:", error));
                }
            }
            requestAnimationFrame(animate);
        }

        function handleGurujiWheelClick(event) {
            if (gurujiIsSpinning || !gurujiLastLandedSegment) return;

            const rect = gurujiCanvas.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;
            const dx = x - gurujiRadius;
            const dy = y - gurujiRadius;
            const dist = Math.sqrt(dx * dx + dy * dy);
            if (dist > gurujiRadius) return;

            const clickAngle = Math.atan2(dy, dx);
            const clickedSegment = getGurujiSegmentAtAngle(clickAngle);
            if (clickedSegment && clickedSegment.number === gurujiLastLandedSegment.number) {
                if (clickedSegment.visible) {
                    gurujiCurrentQuestion = clickedSegment.question;
                    showGurujiQuestionInPopup(gurujiCurrentQuestion.question);
                    clickedSegment.visible = false;
                    drawGurujiWheel();
                } else {
                    document.getElementById('guruji-result').textContent = "Question already answered!";
                    document.getElementById('guruji-result').style.opacity = '1';
                }
            } else {
                alert(`Please click on the landed sector: ${gurujiLastLandedSegment.number}`);
            }
        }

        function openGurujiPopup() {
            const popup = document.getElementById("guruji-popup");
            popup.style.display = "flex";
            drawGurujiWheel();
            playSound("gurujiMusic");
        }

        function closeGurujiPopup() {
            document.getElementById("guruji-popup").style.display = "none";
            stopSound("gurujiMusic");
            document.getElementById('guruji-question-container').classList.remove('visible');
            clearInterval(gurujiTimerInterval);
        }

        // Shared Functions
        function showQuestionModal(question) {
            questionContent.innerHTML = `Question: <span class="highlight">${question}</span>`;
            questionModal.classList.add('active');
            answerBtn.style.display = 'block';
            congratsBtn.style.display = 'none';

            let timeLeft = 60;
            const timerDisplay = document.getElementById('timer');
            timerDisplay.textContent = `Time Left: ${timeLeft}s`;
            timerDisplay.style.opacity = '1';
            timerDisplay.style.animation = 'pulseGlow 1s infinite';
            timerDisplay.style.color = '#ffd700';

            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timeLeft--;
                timerDisplay.textContent = `Time Left: ${timeLeft}s`;

                if (timeLeft <= 10) {
                    timerDisplay.style.color = '#ff6f61';
                    timerDisplay.style.animation = 'pulseGlow 0.5s infinite';
                }

                if (timeLeft <= 0) {
                    clearInterval(timerInterval);
                    questionContent.textContent = "Time's up!";
                    answerBtn.style.display = 'none';
                    timerDisplay.style.opacity = '0';
                    timerDisplay.style.animation = 'none';
                }
            }, 1000);

            answerBtn.onclick = () => {
                if (mainCurrentQuestion) {
                    clearInterval(timerInterval);
                    questionContent.textContent = `Answer: ${mainCurrentQuestion.answer}`;
                    answerBtn.style.display = 'none';
                    congratsBtn.style.display = 'block';
                    timerDisplay.style.opacity = '0';
                    timerDisplay.style.animation = 'none';
                }
            };
        }

        function showGurujiQuestionInPopup(question) {
            const container = document.getElementById('guruji-question-container');
            const content = document.getElementById('guruji-question-content');
            const timerDisplay = document.getElementById('guruji-timer');
            const answerBtn = document.getElementById('guruji-answerBtn');
            const congratsBtn = document.getElementById('guruji-congratsBtn');
            const closeBtn = document.getElementById('closeGurujiQuestion');

            content.innerHTML = `Question: <span class="highlight">${question}</span>`;
            container.classList.add('visible'); // Fade in
            answerBtn.style.display = 'block';
            congratsBtn.style.display = 'none';

            let timeLeft = 60;
            timerDisplay.textContent = `Time Left: ${timeLeft}s`;
            timerDisplay.style.opacity = '1';
            timerDisplay.style.color = '#ffd700';

            clearInterval(gurujiTimerInterval);
            gurujiTimerInterval = setInterval(() => {
                timeLeft--;
                timerDisplay.textContent = `Time Left: ${timeLeft}s`;

                if (timeLeft <= 10) {
                    timerDisplay.style.color = '#ff6f61';
                }

                if (timeLeft <= 0) {
                    clearInterval(gurujiTimerInterval);
                    content.textContent = "Time's up!";
                    answerBtn.style.display = 'none';
                    timerDisplay.style.opacity = '0';
                }
            }, 1000);

            answerBtn.onclick = () => {
                if (gurujiCurrentQuestion) {
                    clearInterval(gurujiTimerInterval);
                    content.textContent = `Answer: ${gurujiCurrentQuestion.answer}`;
                    answerBtn.style.display = 'none';
                    congratsBtn.style.display = 'block';
                    timerDisplay.style.opacity = '0';
                }
            };

            congratsBtn.onclick = () => {
                triggerCelebration();
            };

            closeBtn.onclick = () => {
                container.classList.remove('visible'); // Fade out
                clearInterval(gurujiTimerInterval);
            };
        }

        function hideQuestionModal() {
            questionModal.classList.remove('active');
            answerBtn.style.display = 'none';
            congratsBtn.style.display = 'none';
            clearInterval(timerInterval);
            const timerDisplay = document.getElementById('timer');
            timerDisplay.style.opacity = '0';
            timerDisplay.style.animation = 'none';
            document.body.style.background = 'linear-gradient(135deg, #0a1a3d 0%, #1e3c72 50%, #000000 100%)';
            congratsMessage.style.opacity = '0';
            congratsMessage.style.display = 'none';
            document.querySelectorAll('.confetti, .balloon, .glitter, .ripple, .snowflake, .leaf, .bubble, .confetti-trail').forEach(el => el.remove());
            fireworksDiv.style.opacity = '0';
        }

        function createFireworks() {
            fireworksDiv.innerHTML = '';
            const particleCount = 30;
            const particleColors = ['#ffd700', '#ffaa00', '#ff6f61', '#6b5b95', '#88b04b'];
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                const angle = Math.random() * 2 * Math.PI;
                const distance = Math.random() * 120 + 60;
                const x = Math.cos(angle) * distance;
                const y = Math.sin(angle) * distance;
                particle.style.background = particleColors[Math.floor(Math.random() * particleColors.length)];
                particle.style.setProperty('--x', `${x}px`);
                particle.style.setProperty('--y', `${y}px`);
                fireworksDiv.appendChild(particle);
            }
            fireworksDiv.style.opacity = '1';
            setTimeout(() => fireworksDiv.style.opacity = '0', 1200);
        }

        function triggerCelebration() {
            const effects = [
                () => {
                    for (let i = 0; i < 50; i++) {
                        const confetti = document.createElement('div');
                        confetti.className = 'confetti';
                        confetti.style.left = `${Math.random() * 100}vw`;
                        confetti.style.background = `hsl(${Math.random() * 360}, 100%, 50%)`;
                        confetti.style.animationDelay = `${Math.random() * 0.5}s`;
                        document.body.appendChild(confetti);
                        setTimeout(() => {
                            confetti.style.opacity = '1';
                            setTimeout(() => {
                                confetti.style.opacity = '0';
                                setTimeout(() => confetti.remove(), 300);
                            }, 2700);
                        }, 10);
                    }
                },
                () => {
                    createFireworks();
                },
                () => {
                    document.addEventListener('mousemove', createGlitterTrail);
                    setTimeout(() => {
                        document.removeEventListener('mousemove', createGlitterTrail);
                    }, 3000);
                },
                () => {
                    document.addEventListener('click', createRipple);
                    setTimeout(() => {
                        document.removeEventListener('click', createRipple);
                    }, 3000);
                },
                () => {
                    for (let i = 0; i < 30; i++) {
                        const isSnow = Math.random() > 0.5;
                        const element = document.createElement('div');
                        element.className = isSnow ? 'snowflake' : 'leaf';
                        element.textContent = isSnow ? '❄️' : '🍂';
                        element.style.left = `${Math.random() * 100}vw`;
                        element.style.animationDelay = `${Math.random() * 2}s`;
                        document.body.appendChild(element);
                        setTimeout(() => element.remove(), 5000);
                    }
                },
                () => {
                    document.body.style.background = 'linear-gradient(135deg, red, orange, yellow, green, blue, indigo, violet)';
                    setTimeout(() => {
                        document.body.style.background = 'linear-gradient(135deg, #0a1a3d 0%, #1e3c72 50%, #000000 100%)';
                    }, 2000);
                },
                () => {
                    for (let i = 0; i < 10; i++) {
                        const balloon = document.createElement('div');
                        balloon.className = 'balloon bouncing-balloon';
                        balloon.style.left = `${Math.random() * 100}vw`;
                        balloon.style.background = `hsl(${Math.random() * 360}, 80%, 60%)`;
                        balloon.style.animationDelay = `${Math.random() * 0.5}s`;
                        document.body.appendChild(balloon);
                        setTimeout(() => {
                            balloon.style.opacity = '1';
                            setTimeout(() => {
                                balloon.style.opacity = '0';
                                setTimeout(() => balloon.remove(), 300);
                            }, 3700);
                        }, 10);
                    }
                },
                () => {
                    for (let i = 0; i < 20; i++) {
                        const bubble = document.createElement('div');
                        bubble.className = 'bubble';
                        bubble.style.left = `${Math.random() * 100}vw`;
                        bubble.style.animationDelay = `${Math.random() * 1}s`;
                        document.body.appendChild(bubble);
                        setTimeout(() => bubble.remove(), 2000);
                    }
                },
                () => {
                    const emojis = ['😂', '🔥', '🎉', '🎊', '💥'];
                    for (let i = 0; i < 20; i++) {
                        const emoji = document.createElement('div');
                        emoji.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                        emoji.style.position = 'fixed';
                        emoji.style.left = `${Math.random() * 100}vw`;
                        emoji.style.top = `${Math.random() * 100}vh`;
                        emoji.style.fontSize = '2em';
                        emoji.style.opacity = '1';
                        emoji.style.transition = 'opacity 1s';
                        document.body.appendChild(emoji);
                        setTimeout(() => {
                            emoji.style.opacity = '0';
                            setTimeout(() => emoji.remove(), 1000);
                        }, 1000);
                    }
                },
                () => {
                    document.addEventListener('mousemove', createConfettiTrail);
                    setTimeout(() => {
                        document.removeEventListener('mousemove', createConfettiTrail);
                    }, 3000);
                },
                () => {
                    const isLightMode = Math.random() > 0.5;
                    document.body.style.background = isLightMode ? '#ffffff' : '#000000';
                    fireworksDiv.innerHTML = '';
                    const particleCount = 30;
                    const particleColors = isLightMode ? ['#ff0000', '#00ff00', '#0000ff'] : ['#ffd700', '#ffaa00', '#ff6f61'];
                    for (let i = 0; i < particleCount; i++) {
                        const particle = document.createElement('div');
                        particle.className = 'particle';
                        const angle = Math.random() * 2 * Math.PI;
                        const distance = Math.random() * 120 + 60;
                        const x = Math.cos(angle) * distance;
                        const y = Math.sin(angle) * distance;
                        particle.style.background = particleColors[Math.floor(Math.random() * particleColors.length)];
                        particle.style.setProperty('--x', `${x}px`);
                        particle.style.setProperty('--y', `${y}px`);
                        fireworksDiv.appendChild(particle);
                    }
                    fireworksDiv.style.opacity = '1';
                    setTimeout(() => {
                        fireworksDiv.style.opacity = '0';
                        document.body.style.background = 'linear-gradient(135deg, #0a1a3d 0%, #1e3c72 50%, #000000 100%)';
                    }, 1500);
                }
            ];

            const randomEffect = effects[Math.floor(Math.random() * effects.length)];
            randomEffect();
            celebrationMusic.play().catch(error => console.log("Celebration music failed:", error));
            setTimeout(() => {
                celebrationMusic.pause();
                celebrationMusic.currentTime = 0;
            }, 3000);
        }

        function createGlitterTrail(e) {
            const glitter = document.createElement('div');
            glitter.className = 'glitter';
            glitter.style.left = `${e.pageX}px`;
            glitter.style.top = `${e.pageY}px`;
            document.body.appendChild(glitter);
            setTimeout(() => glitter.remove(), 1000);
        }

        function createRipple(e) {
            const ripple = document.createElement('div');
            ripple.className = 'ripple';
            ripple.style.left = `${e.pageX - 50}px`;
            ripple.style.top = `${e.pageY - 50}px`;
            ripple.style.width = '100px';
            ripple.style.height = '100px';
            document.body.appendChild(ripple);
            setTimeout(() => ripple.remove(), 1000);
        }

        function createConfettiTrail(e) {
            const confetti = document.createElement('div');
            confetti.className = 'confetti-trail';
            confetti.style.left = `${e.pageX}px`;
            confetti.style.top = `${e.pageY}px`;
            confetti.style.setProperty('--hue', Math.random() * 360);
            const angle = Math.random() * 2 * Math.PI;
            const distance = Math.random() * 50 + 20;
            const x = Math.cos(angle) * distance;
            const y = Math.sin(angle) * distance;
            confetti.style.setProperty('--x', `${x}px`);
            confetti.style.setProperty('--y', `${y}px`);
            document.body.appendChild(confetti);
            setTimeout(() => confetti.remove(), 1000);
        }

        function playSound(id) {
            document.getElementById(id).play().catch(error => console.log(`Sound ${id} play failed:`, error));
        }

        function stopSound(id) {
            const sound = document.getElementById(id);
            sound.pause();
            sound.currentTime = 0;
        }

        // Event Listeners
        canvas.addEventListener('click', handleWheelClick);
        spinBtn.addEventListener('click', spinWheel);
        closeModal.addEventListener('click', hideQuestionModal);
        congratsBtn.addEventListener('click', () => {
            triggerCelebration();
        });

        // Guruji Event Listeners
        document.getElementById('guruji-spinBtn').addEventListener('click', spinGurujiWheel);
        gurujiCanvas.addEventListener('click', handleGurujiWheelClick);

        // Initialize
        drawWheel();
    </script>
</body>
</html>