<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Spin the Wheel Game</title>
    <style>
        body { 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            min-height: 100vh; 
            margin: 0; 
            font-family: 'Poppins', sans-serif; 
            background: linear-gradient(135deg, #0a1a3d 0%, #1e3c72 50%, #000000 100%);
            color: #ffffff;
            overflow: hidden;
        }
        .game-container { 
            text-align: center; 
            padding: 30px; 
            position: relative;
            width: 550px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            box-shadow: 0 0 30px rgba(255, 215, 0, 0.3);
        }
        .wheel-container { 
            position: relative; 
            width: 450px; 
            height: 500px; 
            margin: 30px auto; 
            border-radius: 50%;
            background: radial-gradient(circle, #ffd700 10%, transparent 60%);
            /* Removed box-shadow to limit glow to the wheel (canvas) */
        }
        canvas { 
            width: 100%; 
            height: 450px; 
            border-radius: 50%;
            animation: glowWheel 2s infinite alternate;
        }
        .pointer { 
            position: absolute; 
            top: -10px; 
            left: 50%; 
            transform: translateX(-50%); 
            width: 0; 
            height: 0; 
            border-left: 20px solid transparent; 
            border-right: 20px solid transparent; 
            border-top: 40px solid #ffd700; 
            z-index: 10; 
            filter: drop-shadow(0 0 10px #ffd700);
        }
        button { 
            padding: 15px 30px; 
            font-size: 18px; 
            font-weight: bold;
            background: linear-gradient(45deg, #ffd700, #ffaa00);
            color: #0a1a3d; 
            border: none; 
            border-radius: 50px; 
            cursor: pointer; 
            transition: all 0.3s ease; 
            margin: 15px;
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.5);
        }
        button:hover { 
            background: linear-gradient(45deg, #ffaa00, #ffd700);
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(255, 215, 0, 0.7);
        }
        button:disabled { 
            background: #666633; 
            cursor: not-allowed; 
            box-shadow: none;
            transform: none;
        }
        #result { 
            font-size: 24px; 
            font-weight: bold; 
            color: #ffd700; 
            max-width: 450px; 
            word-wrap: break-word; 
            text-shadow: 0 0 15px #ffd700, 0 0 30px #ffaa00; 
            animation: popUp 0.5s ease-out forwards, glowText 1.5s infinite alternate;
            opacity: 0;
            position: absolute; 
            bottom: 15px; 
            left: 0;
            width: 100%; 
            text-align: center; 
            z-index: 5;
        }
        h1 { 
            color: #ffd700; 
            font-size: 48px;
            text-shadow: 0 0 20px #ffd700, 0 0 40px #ffaa00;
            animation: glowText 2s infinite alternate;
            margin-bottom: 20px;
        }
        .gift-box-container {
            display: none; /* Hidden as interaction is now on the wheel */
        }
        @keyframes popUp {
            0% { transform: scale(0.5); opacity: 0; }
            80% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }
        @keyframes glowWheel {
            0% { box-shadow: 0 0 40px rgba(255, 215, 0, 0.5); }
            100% { box-shadow: 0 0 60px rgba(255, 215, 0, 0.8); }
        }
        @keyframes glowText {
            0% { text-shadow: 0 0 15px #ffd700, 0 0 30px #ffaa00; }
            100% { text-shadow: 0 0 25px #ffd700, 0 0 50px #ffaa00; }
        }
        .fireworks {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            pointer-events: none;
            z-index: 10;
            width: 0;
            height: 0;
        }
        .particle {
            position: absolute;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            opacity: 1;
            animation: burst 1.2s ease-out forwards;
            box-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
        }
        @keyframes burst {
            0% { transform: translate(0, 0) scale(1); opacity: 1; }
            100% { transform: translate(var(--x), var(--y)) scale(0); opacity: 0; }
        }
        #questionModal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: rgba(10, 26, 61, 0.4);
            backdrop-filter: blur(15px);
            z-index: 20;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: all 0.3s ease-in-out;
        }
        #questionModal.active {
            display: flex;
        }
        #questionContent {
            font-size: 42px;
            font-weight: 600;
            color: #ffd700;
            text-align: center;
            margin-bottom: 50px;
            padding: 0 30px;
            max-width: 90%;
            text-shadow: 0 0 20px #ffd700, 0 0 40px #ffaa00;
            animation: glowText 1.5s infinite alternate;
        }
        #closeModal {
            position: absolute;
            top: 25px;
            right: 25px;
            cursor: pointer;
            font-size: 36px;
            color: #ffd700;
            text-shadow: 0 0 10px #ffd700;
            transition: all 0.3s ease;
        }
        #closeModal:hover {
            transform: scale(1.2) rotate(90deg);
            color: #ffaa00;
            text-shadow: 0 0 15px #ffaa00;
        }
        #answerBtn {
            font-size: 28px;
            font-weight: bold;
            padding: 20px 50px;
            background: linear-gradient(45deg, #ffd700, #ffaa00);
            box-shadow: 0 5px 15px rgba(255, 215, 0, 0.5);
            transition: all 0.3s ease;
        }
        #answerBtn:hover {
            background: linear-gradient(45deg, #ffaa00, #ffd700);
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(255, 215, 0, 0.8);
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>
    <div class="game-container">
        <h1>Spin the Wheel</h1>
        <div class="wheel-container">
            <div class="pointer"></div>
            <canvas id="wheel" width="450" height="450"></canvas>
            <div id="result">
                <div class="fireworks" id="fireworks"></div>
            </div>
        </div>
        <button id="spinBtn">Spin Now!</button>
        <!-- Gift boxes remain in HTML but are hidden -->
        <div class="gift-box-container">
            <div class="gift-box" data-set="50">?</div>
            <div class="gift-box" data-set="100">?</div>
            <div class="gift-box" data-set="150">?</div>
            <div class="gift-box" data-set="200">?</div>
            <div class="gift-box" data-set="250">?</div>
            <div class="gift-box" data-set="300">?</div>
            <div class="gift-box" data-set="350">?</div>
            <div class="gift-box" data-set="400">?</div>
        </div>
    </div>

    <!-- Modal for Question -->
    <div id="questionModal">
        <div id="closeModal">❌</div>
        <div id="questionContent"></div>
        <button id="answerBtn">Show Answer</button>
    </div>

    <script>
        const canvas = document.getElementById('wheel');
        const ctx = canvas.getContext('2d');
        const spinBtn = document.getElementById('spinBtn');
        const resultDiv = document.getElementById('result');
        const fireworksDiv = document.getElementById('fireworks');
        const questionModal = document.getElementById('questionModal');
        const questionContent = document.getElementById('questionContent');
        const closeModal = document.getElementById('closeModal');
        const answerBtn = document.getElementById('answerBtn');

        const questionSets = {
            "50": [
                { question: "What is the capital of France?", answer: "Paris" },
                { question: "Who wrote 'Romeo and Juliet'?", answer: "William Shakespeare" },
                { question: "What is the largest planet in our solar system?", answer: "Jupiter" },
                { question: "What is the chemical symbol for water?", answer: "H2O" },
                { question: "Who painted the Mona Lisa?", answer: "Leonardo da Vinci" }
            ],
            "100": [
                { question: "What is the smallest prime number?", answer: "2" },
                { question: "What is the square root of 64?", answer: "8" },
                { question: "What is the longest river in the world?", answer: "The Nile" },
                { question: "What is the freezing point of water in Celsius?", answer: "0°C" },
                { question: "Who discovered gravity?", answer: "Isaac Newton" }
            ],
            "150": [
                { question: "What is the capital of Japan?", answer: "Tokyo" },
                { question: "What is the largest ocean on Earth?", answer: "Pacific Ocean" },
                { question: "What is the chemical symbol for gold?", answer: "Au" },
                { question: "Who is known as the father of computers?", answer: "Charles Babbage" },
                { question: "What is the speed of light?", answer: "299,792,458 meters per second" }
            ],
            "200": [
                { question: "What is the capital of Australia?", answer: "Canberra" },
                { question: "What is the largest mammal on Earth?", answer: "Blue Whale" },
                { question: "What is the smallest country in the world?", answer: "Vatican City" },
                { question: "What is the boiling point of water in Celsius?", answer: "100°C" },
                { question: "Who wrote 'The Theory of Relativity'?", answer: "Albert Einstein" }
            ],
            "250": [
                { question: "What is the capital of Brazil?", answer: "Brasília" },
                { question: "What is the largest desert in the world?", answer: "Sahara Desert" },
                { question: "What is the chemical symbol for oxygen?", answer: "O" },
                { question: "Who invented the telephone?", answer: "Alexander Graham Bell" },
                { question: "What is the largest bone in the human body?", answer: "Femur" }
            ],
            "300": [
                { question: "What is the capital of Canada?", answer: "Ottawa" },
                { question: "What is the largest island in the world?", answer: "Greenland" },
                { question: "What is the chemical symbol for carbon?", answer: "C" },
                { question: "Who discovered penicillin?", answer: "Alexander Fleming" },
                { question: "What is the hardest natural substance on Earth?", answer: "Diamond" }
            ],
            "350": [
                { question: "What is the capital of Russia?", answer: "Moscow" },
                { question: "What is the largest continent on Earth?", answer: "Asia" },
                { question: "What is the chemical symbol for silver?", answer: "Ag" },
                { question: "Who wrote 'The Origin of Species'?", answer: "Charles Darwin" },
                { question: "What is the smallest unit of life?", answer: "Cell" }
            ],
            "400": [
                { question: "What is the capital of China?", answer: "Beijing" },
                { question: "What is the largest moon in the solar system?", answer: "Ganymede" },
                { question: "What is the chemical symbol for iron?", answer: "Fe" },
                { question: "Who invented the light bulb?", answer: "Thomas Edison" },
                { question: "What is the largest organ in the human body?", answer: "Skin" }
            ]
        };

        const segments = [
            { number: "50" },
            { number: "100" },
            { number: "150" },
            { number: "200" },
            { number: "250" },
            { number: "300" },
            { number: "350" },
            { number: "400" }
        ];

        const usedQuestions = {
            "50": [], "100": [], "150": [], "200": [], 
            "250": [], "300": [], "350": [], "400": []
        };

        const colors = ['#ff6f61', '#6b5b95', '#88b04b', '#f7cac9', '#92a8d1', '#f9cb9c', '#b565a7', '#009b77'];
        const radius = canvas.width / 2;
        const arc = 2 * Math.PI / segments.length;
        const pointerAngle = 3 * Math.PI / 2;
        let currentAngle = 0;
        let isSpinning = false;
        let currentQuestion = null;
        let lastLandedNumber = null;

        function normalizeAngle(angle) {
            angle = angle % (2 * Math.PI);
            if (angle < 0) angle += 2 * Math.PI;
            return angle;
        }

        function drawWheel() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            segments.forEach((segment, i) => {
                const angle = currentAngle + (i * arc);
                ctx.beginPath();
                ctx.fillStyle = colors[i];
                ctx.moveTo(radius, radius);
                ctx.arc(radius, radius, radius, angle, angle + arc);
                ctx.lineTo(radius, radius);
                ctx.fill();
                ctx.save();
                ctx.translate(radius, radius);
                ctx.rotate(angle + arc / 2);
                ctx.fillStyle = '#0a1a3d';
                ctx.font = 'bold 24px Poppins';
                ctx.textAlign = 'right';
                ctx.fillText(segment.number, radius - 30, 10);
                ctx.restore();
            });
        }

        function getSegmentAtAngle(angle) {
            const relativeAngle = normalizeAngle(angle - currentAngle);
            const segmentIndex = Math.floor(relativeAngle / arc) % segments.length;
            return segments[segmentIndex];
        }

        function handleWheelClick(event) {
            if (isSpinning || !lastLandedNumber) {
                return; /* Ignore clicks during spinning or before first spin */
            }
            const rect = canvas.getBoundingClientRect();
            const x = event.clientX - rect.left;
            const y = event.clientY - rect.top;
            const dx = x - radius;
            const dy = y - radius;
            const dist = Math.sqrt(dx * dx + dy * dy);
            if (dist > radius) {
                return; /* Click outside the wheel */
            }
            const clickAngle = Math.atan2(dy, dx);
            const clickedSegment = getSegmentAtAngle(clickAngle);
            if (clickedSegment.number === lastLandedNumber) {
                currentQuestion = getRandomQuestion(lastLandedNumber);
                showQuestionModal(currentQuestion.question);
            } else {
                alert(`Please click on the landed sector: ${lastLandedNumber}`);
            }
        }

        function getRandomQuestion(setNumber) {
            const availableQuestions = questionSets[setNumber].filter(q => !usedQuestions[setNumber].includes(q));
            if (availableQuestions.length === 0) {
                usedQuestions[setNumber] = [];
                return questionSets[setNumber][0];
            }
            const question = availableQuestions[Math.floor(Math.random() * availableQuestions.length)];
            usedQuestions[setNumber].push(question);
            return question;
        }

        function createFireworks() {
            fireworksDiv.innerHTML = '';
            const particleCount = 30;
            const particleColors = ['#ffd700', '#ffaa00', '#ff6f61', '#6b5b95', '#88b04b'];
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                const angle = Math.random() * 2 * Math.PI;
                const distance = Math.random() * 120 + 60;
                const x = Math.cos(angle) * distance;
                const y = Math.sin(angle) * distance;
                particle.style.background = particleColors[Math.floor(Math.random() * particleColors.length)];
                particle.style.setProperty('--x', `${x}px`);
                particle.style.setProperty('--y', `${y}px`);
                fireworksDiv.appendChild(particle);
            }
        }

        function spinWheel() {
            if (isSpinning) return;
            isSpinning = true;
            spinBtn.disabled = true;
            resultDiv.style.opacity = '0';
            fireworksDiv.innerHTML = '';

            const spins = 5 + Math.floor(Math.random() * 5);
            const randomSegmentIndex = Math.floor(Math.random() * segments.length);
            const segmentCenter = randomSegmentIndex * arc + arc / 2;
            const delta = normalizeAngle(pointerAngle - segmentCenter);
            const targetAngle = delta + 2 * Math.PI * spins;

            let startTime;
            const duration = 5000;

            function animate(timestamp) {
                if (!startTime) startTime = timestamp;
                const elapsed = timestamp - startTime;
                const progress = Math.min(elapsed / duration, 1);
                const easeProgress = 1 - Math.pow(1 - progress, 4);
                currentAngle = easeProgress * targetAngle;
                drawWheel();
                if (progress < 1) {
                    requestAnimationFrame(animate);
                } else {
                    currentAngle = targetAngle;
                    drawWheel();
                    const selected = getSegmentAtAngle(pointerAngle);
                    lastLandedNumber = selected.number;
                    resultDiv.textContent = `You landed on: ${selected.number}`;
                    resultDiv.style.opacity = '1';
                    createFireworks();
                    isSpinning = false;
                    spinBtn.disabled = false;
                }
            }
            requestAnimationFrame(animate);
        }

        function showQuestionModal(question) {
            questionContent.textContent = `Question: ${question}`;
            questionModal.classList.add('active');
            answerBtn.style.display = 'block';
        }

        function hideQuestionModal() {
            questionModal.classList.remove('active');
            answerBtn.style.display = 'none';
        }

        closeModal.addEventListener('click', hideQuestionModal);

        answerBtn.addEventListener('click', () => {
            if (currentQuestion) {
                questionContent.textContent = `Answer: ${currentQuestion.answer}`;
                answerBtn.style.display = 'none';
            }
        });

        canvas.addEventListener('click', handleWheelClick);

        drawWheel();
        spinBtn.addEventListener('click', spinWheel);
    </script>
</body>
</html>