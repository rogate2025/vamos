<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Who Wants to Be a Millionaire - Group Game</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #000;
            color: #fff;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            margin: 0;
        }
        .intro-page, .container {
            width: 100%;
            height: 100%;
        }
        .intro-page {
            background: linear-gradient(to bottom, #000033, #000);
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1000;
        }
        .intro-page h1 {
            font-size: 3em;
            color: #ffd700;
            text-shadow: 2px 2px 4px #000;
        }
        .intro-page button {
            background: linear-gradient(45deg, #ffd700, #ffa500);
            border: 2px solid #ffd700;
            border-radius: 10px;
            color: #000;
            font-size: 1.5em;
            padding: 10px 20px;
            cursor: pointer;
            margin: 10px;
            text-shadow: 1px 1px 2px #fff;
        }
        .container {
            display: none;
            background: radial-gradient(circle, #000066, #000);
            padding: 20px;
        }
        .question {
            font-size: 2em;
            color: #ffd700;
            text-shadow: 2px 2px 4px #000;
        }
        .options {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin: 20px auto;
            width: 80%;
        }
        .options button {
            padding: 15px;
            font-size: 1.5em;
            background: linear-gradient(to bottom, #000066, #000033);
            border: 2px solid #ffd700;
            border-radius: 10px;
            color: #fff;
            cursor: pointer;
            text-shadow: 1px 1px 2px #000;
        }
        .lifelines button {
            background: linear-gradient(to bottom, #ffd700, #ffa500);
            border: 2px solid #fff;
            border-radius: 50%;
            padding: 15px;
            font-size: 1.5em;
            margin: 0 10px;
            text-shadow: 1px 1px 2px #000;
        }
        .timer {
            font-size: 2em;
            color: #ffd700;
            text-shadow: 2px 2px 4px #000;
        }
        #next-question {
            background: linear-gradient(45deg, #ffd700, #ffa500);
            border: 2px solid #ffd700;
            border-radius: 10px;
            color: #000;
            font-size: 1.5em;
            padding: 10px 20px;
            cursor: pointer;
            margin: 10px;
            text-shadow: 1px 1px 2px #fff;
            display: none;
        }
        .manikutti {
            width: 150px;
            position: absolute;
            bottom: 20px;
            right: 20px;
            border-radius: 50%;
        }
        .guruji {
            width: 120px;
            position: absolute;
            bottom: 20px;
            left: 20px;
            border-radius: 50%;
            cursor: pointer;
            transition: transform 0.3s;
        }
        .manikutti:hover, .guruji:hover {
            transform: scale(1.1);
        }
        .guruji-popup {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            animation: fadeInOverlay 0.5s ease-in-out;
        }
        .guruji-content {
            background: linear-gradient(135deg, #ffeb3b, #ff9800, #ff5722);
            padding: 40px;
            border-radius: 25px;
            text-align: center;
            position: relative;
            width: 85%;
            max-width: 700px;
            box-shadow: 0 0 40px rgba(255, 215, 0, 1), 0 0 60px rgba(255, 87, 34, 0.9), 
                        inset 0 0 20px rgba(255, 255, 255, 0.3);
            border: 5px solid #ffd700;
            animation: bounceInPopup 0.7s ease-out;
            overflow: hidden;
        }
        .guruji-content::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255, 215, 0, 0.2), transparent);
            animation: rotateGlow 10s linear infinite;
        }
        .guruji-image {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            margin-bottom: 25px;
            border: 6px solid #ffd700;
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.9), 0 0 30px rgba(255, 87, 34, 0.7);
            animation: spinImage 8s linear infinite;
        }
        .guruji-dialogue {
            font-size: 1.4em;
            color: #333;
            position: relative;
            z-index: 1;
        }
        #guruji-intro {
            font-weight: bold;
            margin-bottom: 20px;
            color: #d81b60;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.6), 0 0 10px #fff;
            animation: slideIn 0.5s ease-in;
            font-size: 1.6em;
        }
        #guruji-question {
            margin-bottom: 25px;
            font-size: 2.2em;
            font-weight: bold;
            font-style: italic;
            color: #fff;
            text-shadow: 4px 4px 8px rgba(0, 0, 0, 0.8), 0 0 15px #ffd700, 0 0 25px #ff5722;
            background: linear-gradient(45deg, rgba(255, 215, 0, 0.3), rgba(255, 87, 34, 0.3));
            padding: 15px 25px;
            border-radius: 15px;
            animation: pulseGlow 1.5s infinite;
        }
        #reveal-answer {
            background: linear-gradient(45deg, #ffd700, #ff5722, #ffaa00);
            border: none;
            padding: 15px 30px;
            cursor: pointer;
            font-size: 1.3em;
            border-radius: 10px;
            color: #fff;
            text-shadow: 2px 2px 4px #000;
            transition: transform 0.3s, box-shadow 0.3s;
            box-shadow: 0 0 15px rgba(255, 87, 34, 0.8);
        }
        #reveal-answer:hover {
            transform: scale(1.1) rotate(2deg);
            box-shadow: 0 0 25px rgba(255, 87, 34, 1), 0 0 35px rgba(255, 215, 0, 0.9);
        }
        #guruji-answer {
            font-weight: bold;
            color: #00e676;
            font-size: 1.8em;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.6), 0 0 15px #fff;
            animation: fadeInAnswer 1s ease-in;
        }
        .guruji-close {
            padding: 10px 20px;
            font-size: 1.2em;
            background: linear-gradient(45deg, #ff5722, #ff9800);
            border: none;
            border-radius: 8px;
            color: #fff;
            text-shadow: 1px 1px 2px #000;
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            position: absolute;
            bottom: 20px;
            right: 20px;
        }
        .guruji-close:hover {
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(255, 87, 34, 0.8);
        }
        @keyframes fadeInOverlay {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes bounceInPopup {
            0% { transform: scale(0.7) rotate(-5deg); opacity: 0; }
            60% { transform: scale(1.05) rotate(2deg); opacity: 1; }
            100% { transform: scale(1) rotate(0deg); }
        }
        @keyframes rotateGlow {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        @keyframes spinImage {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        @keyframes pulseGlow {
            0% { transform: scale(1); box-shadow: 0 0 10px #ffd700; }
            50% { transform: scale(1.03); box-shadow: 0 0 20px #ff5722; }
            100% { transform: scale(1); box-shadow: 0 0 10px #ffd700; }
        }
        @keyframes fadeInAnswer {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        #phone-a-friend-message {
            font-size: 1.5em;
            color: #ffd700;
            text-shadow: 1px 1px 2px #000;
            display: none;
        }
        #custom-confirm {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #ffd700;
            padding: 20px;
            border-radius: 10px;
            display: none;
        }
        #custom-confirm p {
            font-size: 2em;
            color: #000;
            text-shadow: 1px 1px 2px #fff;
        }
        #custom-confirm button {
            font-size: 1.5em;
            margin: 10px;
            background: linear-gradient(45deg, #000066, #000033);
            color: #fff;
            border: 2px solid #000;
            border-radius: 10px;
            padding: 10px 20px;
            cursor: pointer;
        }
        #manikutti-dialogue {
            position: absolute;
            bottom: 140px;
            right: 140px;
            background: #ffd700;
            padding: 15px;
            border-radius: 10px;
            display: none;
        }
        #manikutti-dialogue p {
            font-size: 1.5em;
            color: #000;
            text-shadow: 1px 1px 2px #fff;
        }
        #manikutti-dialogue button {
            font-size: 1.2em;
            background: linear-gradient(45deg, #000066, #000033);
            color: #fff;
            border: 2px solid #000;
            border-radius: 10px;
            padding: 5px 10px;
            cursor: pointer;
        }
        #team-switch-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #ff4500;
            color: #fff;
            padding: 20px;
            border-radius: 10px;
            font-size: 2em;
            text-shadow: 2px 2px 4px #000;
            display: none;
        }
        #time-up-message {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: #ff4500;
            color: #fff;
            padding: 20px;
            border-radius: 10px;
            font-size: 2em;
            text-shadow: 2px 2px 4px #000;
            display: none;
        }
        #guruji-options button.selected {
            background: #ffa500;
        }
    </style>
</head>
<body>
    <!-- Audio Elements -->
    <audio id="backgroundMusic" src="bgm.mp3" loop></audio>
    <audio id="correctSound" src="correct_answer.mp3"></audio>
    <audio id="wrongSound" src="wrong_answer.mp3"></audio>
    <audio id="finalAnswerSound" src="final_answer.mp3"></audio>
    <audio id="lifelineSound" src="lifeline.mp3"></audio>
    <audio id="timerTick" src="timer_tick.mp3" loop></audio>
    <audio id="fastTickSound" src="fast_tick.mp3" loop></audio>
    <audio id="timeUpSound" src="time_up.mp3"></audio>
    <audio id="gurujiMusic" src="guruji.mp3"></audio>
    <audio id="tenSecondsSound" src="ten_seconds.mp3"></audio>
    <audio id="countdownSound" src="countdown.mp3" loop></audio>
    <audio id="nextTeamSound" src="next_team.mp3"></audio>

    <!-- Intro Page -->
    <div id="intro-page" class="intro-page">
        <h1>Welcome to Who Wants to Be a Millionaire - Group Game 🎉</h1>
        <button id="start-game">Start Game 🚀</button>
        <img src="guruji.png" class="guruji" onclick="openGurujiPopup()">
    </div>

    <!-- Game Container -->
    <div class="container" id="game-container">
        <p class="question" id="question"></p>
        <div class="options" id="options"></div>
        <div class="lifelines">
            <button onclick="useFiftyFifty()">50:50 🎲</button>
            <button id="askFriendButton" onclick="toggleAskAFriend()">Ask a Friend 📞</button>
        </div>
        <div class="timer" id="timer">60s ⏰</div>
        <button id="next-question">Next Question ⏭️</button>
        <img src="stay.jpg" class="manikutti" id="manikutti-img">
        <img src="guruji.png" class="guruji" onclick="openGurujiPopup()">
        <p id="phone-a-friend-message"></p>
    </div>

    <!-- Guruji Popup -->
    <div class="guruji-popup" id="guruji-popup">
        <div class="guruji-content">
            <img src="guruji.png" alt="Guruji" class="guruji-image">
            <div class="guruji-dialogue">
                <p id="guruji-intro">Greetings, knowledge seekers! I am Guruji, your Quiz Master. Behold my challenge:</p>
                <p id="guruji-question"></p>
                <div id="guruji-options" class="options"></div>
                <button id="reveal-answer">Reveal Answer</button>
                <p id="guruji-answer" style="display: none;"></p>
            </div>
            <button class="guruji-close" onclick="closeGurujiPopup()">Close</button>
        </div>
    </div>

    <!-- Confirmation Dialog -->
    <div id="custom-confirm">
        <p>Is that your final answer? 🤔</p>
        <button id="confirm-yes">Yes ✅</button>
        <button id="confirm-no">No ❌</button>
    </div>

    <!-- Manikutti Dialog -->
    <div id="manikutti-dialogue">
        <p>Yo! Shall I start the timer? ⏰</p>
        <button id="manikutti-yes">Yes 👍</button>
    </div>

    <!-- Team Switch and Time Up Messages -->
    <div id="team-switch-message"></div>
    <div id="time-up-message">The Time is Up! ⏰</div>

    <script>
        // All Questions Combined
        const allQuestions = [
            {
                "question": "What was the first name given for the orphanage for girls?",
                "options": [
                    "A: Small shelter of the Heart of Jesus",
                    "B: Little girls of the Heart of Jesus",
                    "C: A shelter of the Love of Jesus",
                    "D: Anthonial orphanage"
                ],
                "answer": "A: Small shelter of the Heart of Jesus"
            },
            {
                "question": "Who were the saints that influenced Father to the prayer to obtain priests for the Church?",
                "options": [
                    "A: St. Francis of Assis & St. Anthony",
                    "B: St. Alphonsus & St. Francis de Sales",
                    "C: St. Don Bosco & St. Antony",
                    "D: St. Joseph & Holy Mary"
                ],
                "answer": "B: St. Alphonsus & St. Francis de Sales"
            },
            {
                "question": "Which Pope officially declared the World Day of Prayer for Vocations?",
                "options": [
                    "A: Pius XI",
                    "B: Paul VI",
                    "C: John XXIII",
                    "D: Leo XIII"
                ],
                "answer": "B: Paul VI"
            },
            {
                "question": "What was the name the people of Messina gave to Father Hannibal seeing his works of charity?",
                "options": [
                    "A: Our Father",
                    "B: Our St. Vincent de Paul",
                    "C: Padre",
                    "D: The Father"
                ],
                "answer": "B: Our St. Vincent de Paul"
            },
            {
                "question": "പരീക്ഷകളെ അതിജീവിക്കുന്നവർക്ക് ദൈവം വാഗ്‌ദാനം ചെയ്തിരിക്കുന്നതെന്താണ് (യാക്കോബ് 1:12)?",
                "options": [
                    "A: ജീവന്റെ കിരീടം",
                    "B: നിത്യരക്ഷ",
                    "C: നിത്യ ജീവൻ",
                    "D: ജ്ഞാനം"
                ],
                "answer": "A: ജീവന്റെ കിരീടം"
            },
            {
                "question": "എന്ത് മൂലമാണ് ലോകത്തിൽ വിനാശം ഉണ്ടാകുന്നത് (2 Pet 1:4)?",
                "options": [
                    "A: പാപം മൂലം",
                    "B: ദൈവനിന്ദ മൂലം",
                    "C: ദുരാശ മൂലം",
                    "D: വെറുപ്പു മൂലം"
                ],
                "answer": "C: ദുരാശ മൂലം"
            },
            {
                "question": "ആത്മസംയമനത്തെ എന്തുകൊണ്ടാണ് സമ്പൂര്ണമാക്കാൻ ഉത്സാഹിക്കേണ്ടത് (2 Pet 1:7)?",
                "options": [
                    "A: ജ്ഞാനം കൊണ്ട്",
                    "B: ക്ഷമകൊണ്ട്",
                    "C: സുകൃതം കൊണ്ട്",
                    "D: ഭക്തികൊണ്ട്"
                ],
                "answer": "B: ക്ഷമകൊണ്ട്"
            },
            {
                "question": "യോഹന്നാൻ ശ്ലീഹായുടെ രണ്ടാം ലേഖനം എഴുതപ്പെട്ടതാർക്കു?",
                "options": [
                    "A: വിജാതിയരുടെ ഇടയിൽ ചിതറിപ്പാർക്കുന്നവർക്ക്",
                    "B: വിശ്വാസം സ്വീകരിച്ചവർക്ക്",
                    "C: തെരഞ്ഞെടുക്കപ്പെട്ട മഹതിക്കും അവളുടെ മക്കൾക്കും",
                    "D: ഗായൂസിന്"
                ],
                "answer": "C: തെരഞ്ഞെടുക്കപ്പെട്ട മഹതിക്കും അവളുടെ മക്കൾക്കും"
            },
            {
                "question": "What is identified as the source of Christian hope?",
                "options": [
                    "A: Hope is born of love",
                    "B: Hope does not disappoint us",
                    "C: Hope ensures our faith",
                    "D: Hope is from Christ"
                ],
                "answer": "A: Hope is born of love"
            },
            {
                "question": "Which scriptural passage is cited in paragraph 3 to illustrate reconciliation through Christ’s death?",
                "options": [
                    "A: Romans 6:19",
                    "B: Gal 6:19",
                    "C: Gal 5:19",
                    "D: Romans 5:19"
                ],
                "answer": "D: Romans 5:19"
            },
            {
                "question": "Which virtue closely linked to hope is particularly emphasized?",
                "options": [
                    "A: Love",
                    "B: Perseverance",
                    "C: Patience",
                    "D: Fortitude"
                ],
                "answer": "C: Patience"
            },
            {
                "question": "Which date is set for the opening of the Holy Door at Saint John Lateran?",
                "options": [
                    "A: December 29, 2024",
                    "B: December 25, 2024",
                    "C: December 29, 2025",
                    "D: December 25, 2025"
                ],
                "answer": "A: December 29, 2024"
            }
        ];

        // Guruji Questions
        const gurujiQuestions = [
            { question: "What is the capital of Italy?", options: ["A: Rome", "B: Milan", "C: Naples", "D: Florence"], answer: "A: Rome" },
            { question: "Who wrote 'Hamlet'?", options: ["A: William Shakespeare", "B: Charles Dickens", "C: Mark Twain", "D: Jane Austen"], answer: "A: William Shakespeare" },
            { question: "What is the largest mammal on Earth?", options: ["A: Blue Whale", "B: Elephant", "C: Giraffe", "D: Hippopotamus"], answer: "A: Blue Whale" },
            { question: "What is the chemical symbol for water?", options: ["A: H2O", "B: CO2", "C: O2", "D: NaCl"], answer: "A: H2O" },
            { question: "Who painted the Sistine Chapel ceiling?", options: ["A: Michelangelo", "B: Leonardo da Vinci", "C: Raphael", "D: Donatello"], answer: "A: Michelangelo" },
            { question: "Which planet is closest to the Sun?", options: ["A: Mercury", "B: Venus", "C: Earth", "D: Mars"], answer: "A: Mercury" },
            { question: "What is the tallest mountain in the world?", options: ["A: Mount Everest", "B: K2", "C: Kangchenjunga", "D: Lhotse"], answer: "A: Mount Everest" }
        ];

        // Game State
        let gameState = {
            currentQuestionIndex: 0,
            isFinalAnswer: false,
            currentTeam: "A",
            timer: 60,
            timerInterval: null,
            optionsRevealed: [false, false, false, false],
            firstConfirmation: false,
            isTimerPaused: false,
            fiftyFiftyUsed: false,
            tenSecondsPlayed: false,
            fiveSecondsPlayed: false,
            countdownPlaying: false,
            questionAnswered: false // Track if the question is answered
        };

        // Sound Functions
        function playSound(id) {
            document.getElementById(id).play();
        }

        function stopSound(id) {
            const sound = document.getElementById(id);
            sound.pause();
            sound.currentTime = 0;
        }

        // Question Loading
        function loadQuestion() {
            if (gameState.currentQuestionIndex >= allQuestions.length) {
                document.getElementById("question").textContent = "All questions have been attempted!";
                document.getElementById("options").innerHTML = "";
                document.getElementById("next-question").style.display = "none";
                return;
            }
            const q = allQuestions[gameState.currentQuestionIndex];
            document.getElementById("question").textContent = q.question;
            const options = document.getElementById("options");
            options.innerHTML = "";
            q.options.forEach((opt, i) => {
                const btn = document.createElement("button");
                btn.textContent = opt[0];
                btn.dataset.fullText = opt;
                btn.onclick = () => revealOption(btn, i, opt);
                options.appendChild(btn);
            });
            gameState.optionsRevealed = [false, false, false, false];
            gameState.firstConfirmation = false;
            gameState.timer = 60;
            gameState.isTimerPaused = false;
            gameState.fiftyFiftyUsed = false;
            gameState.tenSecondsPlayed = false;
            gameState.fiveSecondsPlayed = false;
            gameState.countdownPlaying = false;
            gameState.currentTeam = "A";
            gameState.questionAnswered = false; // Reset for new question
            document.getElementById("timer").textContent = `${gameState.timer}s ⏰`;
            clearInterval(gameState.timerInterval);
            stopSound("timerTick");
            stopSound("fastTickSound");
            stopSound("countdownSound");
            document.getElementById("manikutti-dialogue").style.display = "block";
            document.getElementById("time-up-message").style.display = "none";
            document.getElementById("next-question").style.display = "none"; // Hide Next button
        }

        // Option Handling
        function revealOption(btn, index, fullText) {
            if (!gameState.optionsRevealed[index]) {
                btn.textContent = fullText;
                gameState.optionsRevealed[index] = true;
                if (gameState.optionsRevealed.every(r => r)) start30sTimer();
            } else if (!gameState.isTimerPaused) {
                selectAnswer(btn, fullText);
            }
        }

        // Timer Functions
        function start60sTimer() {
            clearInterval(gameState.timerInterval); // Ensure no existing interval
            gameState.timerInterval = setInterval(() => {
                if (!gameState.isTimerPaused) {
                    gameState.timer--;
                    document.getElementById("timer").textContent = `${gameState.timer}s ⏰`;
                    if (gameState.timer === 10 && !gameState.tenSecondsPlayed) {
                        playSound("tenSecondsSound");
                        playSound("countdownSound");
                        gameState.tenSecondsPlayed = true;
                        gameState.countdownPlaying = true;
                    }
                    if (gameState.timer === 5 && !gameState.fiveSecondsPlayed) {
                        stopSound("timerTick");
                        playSound("fastTickSound");
                        gameState.fiveSecondsPlayed = true;
                    }
                    if (gameState.timer <= 0) {
                        clearInterval(gameState.timerInterval);
                        stopSound("timerTick");
                        stopSound("fastTickSound");
                        stopSound("countdownSound");
                        playSound("timeUpSound");
                        showTimeUpMessage();
                        gameState.countdownPlaying = false;
                    }
                }
            }, 1000);
            playSound("timerTick");
        }

        function start30sTimer() {
            clearInterval(gameState.timerInterval); // Clear existing interval
            stopSound("countdownSound");
            gameState.timer = 30;
            gameState.countdownPlaying = false;
            document.getElementById("timer").textContent = `${gameState.timer}s ⏰`;
            start60sTimer();
        }

        function start10sTimer() {
            clearInterval(gameState.timerInterval); // Clear existing interval
            stopSound("countdownSound");
            gameState.timer = 10;
            gameState.tenSecondsPlayed = true;
            gameState.fiveSecondsPlayed = true;
            gameState.countdownPlaying = true;
            document.getElementById("timer").textContent = `${gameState.timer}s ⏰`;
            playSound("countdownSound");
            playSound("fastTickSound");
            start60sTimer();
        }

        function resumeTimer() {
            if (gameState.timer <= 10 && !gameState.countdownPlaying) {
                playSound("countdownSound");
                gameState.countdownPlaying = true;
            }
            if (gameState.timer <= 5 && !gameState.fiveSecondsPlayed) {
                stopSound("timerTick");
                playSound("fastTickSound");
                gameState.fiveSecondsPlayed = true;
            }
            start60sTimer();
        }

        function showTimeUpMessage() {
            const timeUpMsg = document.getElementById("time-up-message");
            timeUpMsg.style.display = "block";
            const q = allQuestions[gameState.currentQuestionIndex];
            const correct = q.answer;
            document.querySelectorAll(".options button").forEach(btn => {
                if (btn.dataset.fullText === correct) {
                    btn.style.background = "#00ff00";
                }
            });
            gameState.questionAnswered = true;
            document.getElementById("next-question").style.display = "block"; // Show Next button
            setTimeout(() => {
                timeUpMsg.style.display = "none";
            }, 3000);
        }

        // Answer Handling
        function selectAnswer(btn, selected) {
            btn.style.background = "#ffa500";
            const confirmBox = document.getElementById("custom-confirm");
            confirmBox.style.display = "block";
            document.getElementById("confirm-yes").onclick = () => {
                confirmBox.style.display = "none";
                playSound("finalAnswerSound");
                gameState.isFinalAnswer = true;
                checkAnswer(btn, selected);
            };
            document.getElementById("confirm-no").onclick = () => {
                confirmBox.style.display = "none";
                btn.style.background = "linear-gradient(to bottom, #000066, #000033)";
            };
        }

        function checkAnswer(btn, selected) {
            clearInterval(gameState.timerInterval);
            stopSound("timerTick");
            stopSound("fastTickSound");
            stopSound("countdownSound");
            gameState.countdownPlaying = false;
            const q = allQuestions[gameState.currentQuestionIndex];
            const correct = q.answer;
            if (!gameState.firstConfirmation) {
                gameState.firstConfirmation = true;
                if (selected === correct) {
                    playSound("correctSound");
                    btn.style.background = "#00ff00";
                    gameState.questionAnswered = true;
                    document.getElementById("next-question").style.display = "block"; // Show Next button
                } else {
                    btn.style.background = "#ff0000";
                    if (gameState.fiftyFiftyUsed) {
                        setTimeout(() => {
                            document.querySelectorAll(".options button").forEach(b => {
                                if (b.dataset.fullText === correct) b.style.background = "#00ff00";
                            });
                            gameState.questionAnswered = true;
                            document.getElementById("next-question").style.display = "block"; // Show Next button
                        }, 1000);
                    } else {
                        setTimeout(switchToNextTeam, 1000);
                    }
                }
            } else {
                if (selected === correct) {
                    playSound("correctSound");
                    btn.style.background = "#00ff00";
                    gameState.questionAnswered = true;
                    document.getElementById("next-question").style.display = "block"; // Show Next button
                } else {
                    playSound("wrongSound");
                    btn.style.background = "#ff0000";
                    document.querySelectorAll(".options button").forEach(b => {
                        if (b.dataset.fullText === correct) b.style.background = "#00ff00";
                    });
                    gameState.questionAnswered = true;
                    document.getElementById("next-question").style.display = "block"; // Show Next button
                }
            }
        }

        // Team Switching
        function switchToNextTeam() {
            gameState.currentTeam = gameState.currentTeam === "A" ? "B" : "A";
            const msg = document.getElementById("team-switch-message");
            msg.textContent = `Team ${gameState.currentTeam === "A" ? "B" : "A"} got it wrong. Next Team, you have 10 seconds! ⏳`;
            msg.style.display = "block";
            playSound("nextTeamSound");
            setTimeout(() => {
                msg.style.display = "none";
                start10sTimer();
            }, 2000);
        }

        // Lifelines
        function useFiftyFifty() {
            playSound("lifelineSound");
            gameState.fiftyFiftyUsed = true;
            const q = allQuestions[gameState.currentQuestionIndex];
            let wrong = q.options.filter(o => o !== q.answer);
            let toRemove = wrong.slice(0, 2);
            document.querySelectorAll(".options button").forEach(btn => {
                if (toRemove.includes(btn.dataset.fullText)) {
                    btn.textContent = "Eliminated 🚫";
                    btn.disabled = true;
                    btn.style.background = "grey";
                } else {
                    btn.textContent = btn.dataset.fullText;
                    gameState.optionsRevealed[q.options.indexOf(btn.dataset.fullText)] = true;
                }
            });
            start30sTimer();
        }

        function toggleAskAFriend() {
            const btn = document.getElementById("askFriendButton");
            if (!gameState.isTimerPaused) {
                playSound("lifelineSound");
                gameState.isTimerPaused = true;
                clearInterval(gameState.timerInterval);
                stopSound("timerTick");
                stopSound("fastTickSound");
                if (gameState.countdownPlaying) stopSound("countdownSound");
                document.getElementById("phone-a-friend-message").textContent = "Now you can Ask your Friend 📞 (Click 'Ask a Friend' again to resume)";
                document.getElementById("phone-a-friend-message").style.display = "block";
                btn.textContent = "Resume Timer ⏳";
            } else {
                gameState.isTimerPaused = false;
                document.getElementById("phone-a-friend-message").style.display = "none";
                btn.textContent = "Ask a Friend 📞";
                resumeTimer();
            }
        }

        // Guruji Popup
        function openGurujiPopup() {
            const popup = document.getElementById("guruji-popup");
            popup.style.display = "flex";
            const questionElem = document.getElementById("guruji-question");
            const answerElem = document.getElementById("guruji-answer");
            const revealBtn = document.getElementById("reveal-answer");
            const optionsDiv = document.getElementById("guruji-options");

            stopSound("backgroundMusic");
            playSound("gurujiMusic");
            answerElem.style.display = "none";
            revealBtn.style.display = "block";
            optionsDiv.innerHTML = "";

            const randomIndex = Math.floor(Math.random() * gurujiQuestions.length);
            const selectedQuestion = gurujiQuestions[randomIndex];
            const correctAnswer = selectedQuestion.answer;

            questionElem.textContent = selectedQuestion.question;

            selectedQuestion.options.forEach((opt, i) => {
                const btn = document.createElement("button");
                btn.textContent = opt;
                btn.className = "guruji-option";
                btn.onclick = () => {
                    document.querySelectorAll(".guruji-option").forEach(b => b.classList.remove("selected"));
                    btn.classList.add("selected");
                };
                optionsDiv.appendChild(btn);
            });

            revealBtn.onclick = () => {
                const selectedBtn = document.querySelector(".guruji-option.selected");
                if (selectedBtn) {
                    const selectedText = selectedBtn.textContent;
                    if (selectedText === correctAnswer) {
                        playSound("correctSound");
                        selectedBtn.style.background = "#00ff00";
                        answerElem.textContent = "Correct! 🎉";
                    } else {
                        playSound("wrongSound");
                        selectedBtn.style.background = "#ff0000";
                        answerElem.textContent = `Wrong! The correct answer is ${correctAnswer} ❌`;
                        document.querySelectorAll(".guruji-option").forEach(btn => {
                            if (btn.textContent === correctAnswer) {
                                btn.style.background = "#00ff00";
                            }
                        });
                    }
                    answerElem.style.display = "block";
                    revealBtn.style.display = "none";
                    document.querySelectorAll(".guruji-option").forEach(btn => {
                        btn.disabled = true;
                    });
                } else {
                    alert("Please select an option first!");
                }
            };
        }

        function closeGurujiPopup() {
            document.getElementById("guruji-popup").style.display = "none";
            stopSound("gurujiMusic");
            playSound("backgroundMusic");
        }

        // Next Question Function
        function goToNextQuestion() {
            if (gameState.questionAnswered) {
                gameState.currentQuestionIndex++;
                loadQuestion();
            }
        }

        // Event Listeners
        document.getElementById("start-game").onclick = () => {
            document.getElementById("intro-page").style.display = "none";
            document.getElementById("game-container").style.display = "block";
            gameState.currentQuestionIndex = 0;
            loadQuestion();
            playSound("backgroundMusic");
        };

        document.getElementById("manikutti-yes").onclick = () => {
            document.getElementById("manikutti-dialogue").style.display = "none";
            document.getElementById("manikutti-img").src = "run.gif";
            start60sTimer();
        };

        document.getElementById("next-question").onclick = goToNextQuestion;
    </script>
</body>
</html>